---
title: "Actividad: Expertas en monstruología"
format: html
editor: visual
---

# Actividad: Expertas en monstruología
Cristobal Medina Meza | A01643121


### Lectura de datos
```{r}
library(DescTools)
library(tidyverse)
library(ggplot2)
library(tidyr)
library(readxl)
```

```{r}
data1 = read.csv("C:/Users/crist/Downloads/datos_act/criaturas_mitologicas.csv")
head(data1)
```

```{r}
data2 = read.csv("C:/Users/crist/Downloads/datos_act/criaturas_sobrenaturales_100.csv")
head(data2)
```

```{r}
data3 = read.csv("C:/Users/crist/Downloads/datos_act/DatosCriaturas.csv")
head(data3)
```

```{r}
data4 = read_excel("C:/Users/crist/Downloads/datos_act/criaturas_ghostbusters.xlsx")
head(data4)
```

```{r}
data5 = read.csv("C:/Users/crist/Downloads/datos_act/datos_moun.csv", sep = ";")
data5
```

### Cambio de nombre de columnas

```{r}
colnames(data1) <- c("Nombre", "Altura", "Peso", "Velocidad", "Peligrosidad", "Esperanza_de_vida")
colnames(data2) <- c("Nombre", "Altura", "Peso", "Velocidad", "Peligrosidad", "Esperanza_de_vida")
colnames(data3) <- c("Nombre", "Altura", "Peso", "Velocidad", "Peligrosidad", "Esperanza_de_vida")
colnames(data4) <- c("Nombre", "Altura", "Peso", "Velocidad", "Peligrosidad", "Esperanza_de_vida")
colnames(data5) <- c("Nombre", "Altura", "Peso", "Velocidad", "Peligrosidad", "Esperanza_de_vida")
data5$Esperanza_de_vida[data5$Esperanza_de_vida == "Inmortal"] <- 9999
```

### Quitar datos duplicados

```{r}
data1 <- data1[!duplicated(data1), ]
data2 <- data2[!duplicated(data2), ]
data3 <- data3[!duplicated(data3), ]
data4 <- data4[!duplicated(data4), ]
data5 <- data5[!duplicated(data5), ]
```

## Atributos medios verdaderos
```{r}
data_full <- rbind(data1, data2, data3, data4, data5)
```

```{r}
data_full <- data_full[!duplicated(data_full), ]
data_full
```

```{r}
data_full$Esperanza_de_vida <- as.numeric(data_full$Esperanza_de_vida)
```

### Vector de medias de los atributos numéricos de los monstruos y seres mitológicos.
```{r}
means <- sapply(data_full, function(x) if(is.numeric(x)) mean(x, na.rm = TRUE) else NA)
means
```
##  Prueba de hipótesis: los atributos de sus monstruos coinciden estadísticamente con el vector real de la población.
```{r}
mu_0 = c(10.615348,5277.962398,40.258258,7.172131,43187.293033)
```

```{r}
data5$Esperanza_de_vida <- as.numeric(data5$Esperanza_de_vida)
```


```{r}
X = data5 |>
      select(-Nombre)
```

```{r}
HotellingsT2Test(x = X, mu = mu_0)
```
No se rechaza que las medias de nuestros mounstruos son diferentes a los atributos medios verdaderos de la población de monstruos.


## Prueba de hipótesis para ver si los atributos medios de sus monstruos difieren con los de algún otro equipo.

```{r}
means_team<- sapply(data5, function(x) if(is.numeric(x)) mean(x, na.rm = TRUE) else NA)
means_team
```

```{r}
mu_0_team = c(21.336,4865.576,47.520,7.336,3139.880)
```


### Equipo 1:

```{r}
X_1 = data1 |>
      select(-Nombre)
```

```{r}
HotellingsT2Test(x = X_1, mu = mu_0_team)
```
No se rechaza que las medias de nuestros mounstruos son diferentes a los atributos medios del equipo 1.

### Equipo 2:

```{r}
X_2 = data2 |>
      select(-Nombre)
```

```{r}
HotellingsT2Test(x = X_2, mu = mu_0_team)
```
No se rechaza que las medias de nuestros mounstruos son diferentes a los atributos medios del equipo 1.

### Equipo 3:

```{r}
X_3 = data3 |>
      select(-Nombre)
```

```{r}
HotellingsT2Test(x = X_3, mu = mu_0_team)
```
No se rechaza que las medias de nuestros mounstruos son diferentes a los atributos medios del equipo 1.

### Equipo 4:

```{r}
X_4 = data4 |>
      select(-Nombre)
```

```{r}
HotellingsT2Test(x = X_4, mu = mu_0_team)
```
No se rechaza que las medias de nuestros mounstruos son diferentes a los atributos medios del equipo 1.
